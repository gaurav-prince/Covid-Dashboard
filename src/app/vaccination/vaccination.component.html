<div class="container">
    <div class="heading">
        <p>You can now check the Availability of Vaccinations near you.</p>
    </div>
    <mat-tab-group (selectedTabChange)="onTabChange()">
        <mat-tab>
            <ng-template mat-tab-label>
                <mat-icon> person_pin_circle</mat-icon>
                <span>Find by your Pincode</span>
            </ng-template>
            <mat-form-field appearance="fill" class="field">
                <mat-label>Pincode</mat-label>
                <input matInput placeholder="Enter your Pincode" [(ngModel)]='pincode'>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Choose a date</mat-label>
                <input matInput [matDatepicker]="picker" required (dateChange)="onChangeDate($event.value)">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
            <br />
            <div *ngIf="!loaded" class="submit">
                <button mat-raised-button class="btn btn-primary" (click)="onSubmitWithPin()">Get Availability</button>
            </div>
            <div class="table-box">
                <table *ngIf="loaded" mat-table [dataSource]="dataSource" class="mat-elevation-z8">
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let session"> {{session.name}} </td>
                </ng-container>

                <ng-container matColumnDef="address">
                    <th mat-header-cell *matHeaderCellDef> Address </th>
                    <td mat-cell *matCellDef="let session"> {{session.address}} </td>
                </ng-container>

                <ng-container matColumnDef="district">
                    <th mat-header-cell *matHeaderCellDef> District </th>
                    <td mat-cell *matCellDef="let session"> {{session.district_name}} </td>
                </ng-container>

                <ng-container matColumnDef="age">
                    <th mat-header-cell *matHeaderCellDef> Age Limit </th>
                    <td mat-cell *matCellDef="let session"> {{session.min_age_limit}}+ </td>
                </ng-container>

                <ng-container matColumnDef="time">
                    <th mat-header-cell *matHeaderCellDef> Time </th>
                    <td mat-cell *matCellDef="let session"> {{session.from}} to {{session.to}} </td>
                </ng-container>

                <ng-container matColumnDef="fee_type">
                    <th mat-header-cell *matHeaderCellDef> Free/ Paid </th>
                    <td mat-cell *matCellDef="let session"> {{session.fee_type}} </td>
                </ng-container>

                <ng-container matColumnDef="fee">
                    <th mat-header-cell *matHeaderCellDef> Fee </th>
                    <td mat-cell *matCellDef="let session"> {{session.fee}} </td>
                </ng-container>

                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef> Date </th>
                    <td mat-cell *matCellDef="let session"> {{session.date}} </td>
                </ng-container>

                <ng-container matColumnDef="available_capacity">
                    <th mat-header-cell *matHeaderCellDef> Availabile Slots </th>
                    <td mat-cell *matCellDef="let session" [ngClass]="{
                        'available':session.available_capacity!=0,
                        'notAvailable':session.available_capacity==0}"> {{session.available_capacity}} </td>
                </ng-container>

                <ng-container matColumnDef="vaccine">
                    <th mat-header-cell *matHeaderCellDef> Vaccine </th>
                    <td mat-cell *matCellDef="let session"> {{session.vaccine}} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
            </div>
        </mat-tab>


        <mat-tab>
            <ng-template mat-tab-label>
                <mat-icon> location_city</mat-icon>
                <span>Find by your District</span>
            </ng-template>
            <mat-form-field appearance="fill" class="state_field">
                <mat-label>Select State</mat-label>
                <mat-select (selectionChange)="onChangeState($event.value)">
                    <mat-option *ngFor="let state of states.states" [value]="state.state_id">{{state.state_name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill" class="city_field">
                <mat-label>Select City</mat-label>
                <mat-select (selectionChange)="onChangeCity($event.value)">
                    <mat-option *ngFor="let city of cities.districts" [value]="city.district_id">{{city.district_name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Choose a date</mat-label>
                <input matInput [matDatepicker]="picker2" required (dateChange)="onChangeDate($event.value)">
                <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
            <br />
            <div class="submit" *ngIf="!loaded">
                <button mat-raised-button class="btn btn-primary" (click)="onSubmitDistrict()">Get Availability</button>
            </div>
            <div class="table-box">
            <table *ngIf="loaded" mat-table [dataSource]="dataSource" class="mat-elevation-z8">

                <!--- Note that these columns can be defined in any order.
                      The actual rendered columns are set as a property on the row definition" -->
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let session"> {{session.name}} </td>
                </ng-container>

                <!-- Address Column -->
                <ng-container matColumnDef="address">
                    <th mat-header-cell *matHeaderCellDef> Address </th>
                    <td mat-cell *matCellDef="let session"> {{session.address}} </td>
                </ng-container>

                <!-- District Column -->
                <ng-container matColumnDef="district">
                    <th mat-header-cell *matHeaderCellDef> District </th>
                    <td mat-cell *matCellDef="let session"> {{session.district_name}} </td>
                </ng-container>

                <ng-container matColumnDef="age">
                    <th mat-header-cell *matHeaderCellDef> Age Limit </th>
                    <td mat-cell *matCellDef="let session"> {{session.min_age_limit}}+ </td>
                </ng-container>

                <ng-container matColumnDef="time">
                    <th mat-header-cell *matHeaderCellDef> Time </th>
                    <td mat-cell *matCellDef="let session"> {{session.from}} to {{session.to}} </td>
                </ng-container>
               
                <ng-container matColumnDef="fee_type">
                    <th mat-header-cell *matHeaderCellDef> Free/ Paid </th>
                    <td mat-cell *matCellDef="let session"> {{session.fee_type}} </td>
                </ng-container>

                <ng-container matColumnDef="fee">
                    <th mat-header-cell *matHeaderCellDef> Fee </th>
                    <td mat-cell *matCellDef="let session"> {{session.fee}} </td>
                </ng-container>

                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef> Date </th>
                    <td mat-cell *matCellDef="let session"> {{session.date}} </td>
                </ng-container>
                
                <ng-container matColumnDef="available_capacity">
                    <th mat-header-cell *matHeaderCellDef> Availabile Slots </th>
                    <td mat-cell *matCellDef="let session" [ngClass]="{
                        'available':session.available_capacity!=0,
                        'notAvailable':session.available_capacity==0}"> {{session.available_capacity}} </td>
                </ng-container>

                <ng-container matColumnDef="vaccine">
                    <th mat-header-cell *matHeaderCellDef> Vaccine </th>
                    <td mat-cell *matCellDef="let session"> {{session.vaccine}} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </div>
        </mat-tab>


        <mat-tab>
            <ng-template mat-tab-label>
                <mat-icon>view_week</mat-icon>
                <span>Find Availabiity for the Week by your Pincode</span>
            </ng-template>
            <mat-form-field appearance="fill" class="field">
                <mat-label>Pincode</mat-label>
                <input matInput placeholder="Enter your Pincode" [(ngModel)]='pincode'>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Choose a date</mat-label>
                <input matInput [matDatepicker]="picker3" required (dateChange)="onChangeDate($event.value)">
                <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                <mat-datepicker #picker3></mat-datepicker>
            </mat-form-field>
            <br />
            <div *ngIf="!loaded" class="submit">
                <button mat-raised-button class="btn btn-primary" (click)="onSubmitWithPinWeek()">Get
                    Availability</button>
            </div>
            <div class="table-box">
            <table *ngIf="loaded" mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">

                <!--- Note that these columns can be defined in any order.
                      The actual rendered columns are set as a property on the row definition" -->
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
                    <td mat-cell *matCellDef="let session"> {{session.name}} </td>
                </ng-container>

                <!-- Address Column -->
                <ng-container matColumnDef="address">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Address </th>
                    <td mat-cell *matCellDef="let session"> {{session.address}} </td>
                </ng-container>

                <ng-container matColumnDef="district">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> District </th>
                    <td mat-cell *matCellDef="let session"> {{session.district_name}} </td>
                </ng-container>
                
                <ng-container matColumnDef="age">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Age Limit </th>
                    <td mat-cell *matCellDef="let session"> {{session.min_age_limit}}+ </td>
                </ng-container>

                <ng-container matColumnDef="time">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Time </th>
                    <td mat-cell *matCellDef="let session"> {{session.from}} to {{session.to}} </td>
                </ng-container>
                
                <ng-container matColumnDef="fee_type">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Free/ Paid </th>
                    <td mat-cell *matCellDef="let session"> {{session.fee_type}} </td>
                </ng-container>

                <ng-container matColumnDef="fee">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Fee </th>
                    <td mat-cell *matCellDef="let session"> {{session.fee}} </td>
                </ng-container>

                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Date </th>
                    <td mat-cell *matCellDef="let session"> {{session.date}} </td>
                </ng-container>
                
                <ng-container matColumnDef="available_capacity">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Availabile Slots </th>
                    <td mat-cell *matCellDef="let session" [ngClass]="{
                        'available':session.available_capacity!=0,
                        'notAvailable':session.available_capacity==0}"> {{session.available_capacity}} </td>
                </ng-container>

                <ng-container matColumnDef="vaccine">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Vaccine </th>
                    <td mat-cell *matCellDef="let session"> {{session.vaccine}} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </div>
        </mat-tab>


        <mat-tab>
            <ng-template mat-tab-label>
                <mat-icon>view_week</mat-icon>
                <span>Find Vaccines for week by your District</span>
            </ng-template>
            <mat-form-field appearance="fill" class="state_field">
                <mat-label>Select State</mat-label>
                <mat-select (selectionChange)="onChangeState($event.value)">
                    <mat-option *ngFor="let state of states.states" [value]="state.state_id">{{state.state_name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill" class="city_field">
                <mat-label>Select City</mat-label>
                <mat-select (selectionChange)="onChangeCity($event.value)">
                    <mat-option *ngFor="let city of cities.districts" [value]="city.district_id">{{city.district_name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Choose a date</mat-label>
                <input matInput [matDatepicker]="picker4" required (dateChange)="onChangeDate($event.value)">
                <mat-datepicker-toggle matSuffix [for]="picker4"></mat-datepicker-toggle>
                <mat-datepicker #picker4></mat-datepicker>
            </mat-form-field>
            <br />
            <div class="submit" *ngIf="!loaded">
                <button mat-raised-button class="btn btn-primary" (click)="onSubmitDistrictWeek()">Get
                    Availability</button>
            </div>
            <div class="table-box">
                <table *ngIf="loaded" mat-table [dataSource]="dataSource" class="mat-elevation-z8">

                <!--- Note that these columns can be defined in any order.
                      The actual rendered columns are set as a property on the row definition" -->
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let session"> {{session.name}} </td>
                </ng-container>

                <!-- Address Column -->
                <ng-container matColumnDef="address">
                    <th mat-header-cell *matHeaderCellDef> Address </th>
                    <td mat-cell *matCellDef="let session"> {{session.address}} </td>
                </ng-container>

                <!-- District Column -->
                <ng-container matColumnDef="district">
                    <th mat-header-cell *matHeaderCellDef> District </th>
                    <td mat-cell *matCellDef="let session"> {{session.district_name}} </td>
                </ng-container>

                <ng-container matColumnDef="age">
                    <th mat-header-cell *matHeaderCellDef> Age Limit </th>
                    <td mat-cell *matCellDef="let session"> {{session.min_age_limit}}+</td>
                </ng-container>

                <ng-container matColumnDef="time">
                    <th mat-header-cell *matHeaderCellDef> Time </th>
                    <td mat-cell *matCellDef="let session"> {{session.from}} to {{session.to}} </td>
                </ng-container>
                
                <ng-container matColumnDef="fee_type">
                    <th mat-header-cell *matHeaderCellDef> Free/ Paid </th>
                    <td mat-cell *matCellDef="let session"> {{session.fee_type}} </td>
                </ng-container>

                <ng-container matColumnDef="fee">
                    <th mat-header-cell *matHeaderCellDef> Fee </th>
                    <td mat-cell *matCellDef="let session"> {{session.fee}} </td>
                </ng-container>

                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef> Date </th>
                    <td mat-cell *matCellDef="let session"> {{session.date}} </td>
                </ng-container>
                
                <ng-container matColumnDef="available_capacity">
                    <th mat-header-cell *matHeaderCellDef> Availabile Slots </th>
                    <td mat-cell *matCellDef="let session" [ngClass]="{
                        'available':session.available_capacity!=0,
                        'notAvailable':session.available_capacity==0}"> {{session.available_capacity}} </td>
                </ng-container>

                <ng-container matColumnDef="vaccine">
                    <th mat-header-cell *matHeaderCellDef> Vaccine </th>
                    <td mat-cell *matCellDef="let session"> {{session.vaccine}} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
            </div>
        </mat-tab>
    </mat-tab-group>
</div>